#《你不知道的Javascript》上卷

* [美] Kyle Simpson 著
*  赵望野 梁杰 译
*  2015年4月 第一版
*  2016年9月 第6次印刷

## 序

> Javascript 语言本质上有许多复杂的概念，但是却用一种看起来比较简单的方式体现出来，比如闭包，因此Javascript开发者通常只是简单的使用这些特性，并不会关心语言内部的实现原理

> 由于Javascript不必理解就可以使用，因此通常来说很难真正理解语言本身，这就是我们面临的挑战

## 作用域和闭包
### 什么是作用域

> 变量存储在哪，如何找到他们，需要一套设计良好的规则，这套规则就是作用域

**存储变量中的值 是几乎所有编程语言最基本的功能**

#### 1) 传统编译语言的三部流程

> 例：var a=2;

> 1. 分词/词法分析
	* 将字符组成的字符串分解成有意义的代码块（词法单元）
	* var、a、=、2、；

> 2. 解析/语法分析
	* 抽象语法树（AST）
	* VariableDeclaration
		* Identifier(a)
		* AssignmentExprssion
			* NumericLiteral(2) 
> 3. 代码生成 
	* 将AST转化成可执行的代码生成

Javascript引擎编译过程要更复杂，如在语法分析和代码生成阶段都有特定步骤来对运行性能进行优化，包括对荣誉元素进行优化

**Javascript的编译过程不是发生在构建之前，编译发生在执行前**

#### 2) 作用域在编译环节中都做什么

> 演员表

> * 引擎
	* 从头到尾负责JS的编译及执行	
> * 编译器
	* 语法分析及代码生成 
> * 作用域
	* 收集并维护所有声明的标识符组成的一系列查询
	* 确定当前执行的代码对这些标识符的访问权限

> 对话

> 1. 编译器 
	1. 分解成词法单元
	2. 将此词法单元解析成树结构
	
> * 为一个变量分配内存
> * 将其命名为a
> * 将2保存在这个变量中

> 1. 遇到var a
	1. 询问作用域
	2. 是否有一个该名称的变量存在于同一个作用域集合中
		* 1.忽略声明，继续编译
		* 0.要求作用域在当前作用域的集合中声明一个新的变量，命名为a   
> 2. 为引擎生成运行时所需的代码
	1. 询问作用域，是否存在变量a
		* 1.使用这个变量
		* 0.继续查找
			* 1. 将2赋值给a
			* 0. 举手示意并抛出异常

#### 3) 作用域的嵌套
> 当一个块或者函数嵌套在另一个块或者函数中时，就发生了作用域嵌套

#### 4) 作用域查询

* LHS
	* 变量赋值
	* 查好失败，创建变量
	* 严格模式下抛出异常 ReferenceError
* RHS
	* 获取变量值 
	* 查找失败，抛出异常 ReferenceError

typeError 查找到变量，但没有按照变量规则赋值，抛出的异常 

### 词法作用域

工作模式

* 词法作用域
	* 被大多数编程语言采用 
* 动态作用域 
	* Bash脚本、 Perl中的一些模式

### 函数作用域和块作用域
### 提升
### 作用域闭包
## this和对象原型
### 关于this
### this全面解析
### 对象
### 原型
### 行为委托

